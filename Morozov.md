# Курсовая работа

**Тема:** База данных агентства по аренде квартир.

**Студент:** Морозов Николай Константинович.

**Группа:** 414.

# Содержание

- [Введение](#введение)
- [Анализ предметной области](#анализ-предметной-области)
- [Инфологическая модель базы данных](#инфологическая-модель-базы-данных)
- [Логическая структура базы данных](#логическая-структура-базы-данных)
- [Физическая структура базы данных](#физическая-структура-базы-данных)
- [Реализация проекта в СУБД](#реализация-проекта-в-субд)
- [Заключение](#заключение)
- [Список использованных источников](#список-использованных-источников)


# Введение

## Актуальность
В условиях современного города спрос на аренду недвижимости неуклонно растет, особенно в густонаселенных мегаполисах, а также в университетских и студенческих городах. Этот спрос обусловлен множеством факторов, включая экономические, социальные и демографические изменения. Урбанизация, высокая мобильность населения, стремительный рост стоимости жилья и потребность в гибком варианте проживания делают аренду более привлекательной, особенно для молодежи и приезжих специалистов. Рынок аренды недвижимости становится всё более насыщенным и разнообразным, так как клиенты ожидают широкого выбора квартир и гибких условий аренды. В ответ на растущие требования клиентов, агентства по аренде квартир должны оперативно обрабатывать и анализировать огромные объемы данных, касающихся характеристик квартир, профилей клиентов, условий аренды и многих других параметров. 

Сегодня базы данных играют решающую роль в организации работы агентств по аренде недвижимости. С их помощью можно структурировать и хранить большие объемы информации, что облегчает управление данными и упрощает процесс принятия решений. Для агентств внедрение современных баз данных позволяет автоматизировать рутинные операции, такие как учет информации о жилье, учёт запросов клиентов и анализ текущих тенденций на рынке. Это не только значительно повышает скорость работы агентства, но и позволяет улучшить качество сервиса, предоставляемого клиентам. Базы данных также помогают уменьшить вероятность ошибок, возникающих при ручной обработке данных, что делает работу агентства более прозрачной и надёжной. Важно отметить, что эффективная работа с базой данных не только повышает продуктивность агентства, но и улучшает клиентский опыт, поскольку клиенты могут быстрее находить жилье, которое соответствует их запросам. Это способствует повышению удовлетворенности клиентов, их лояльности и долгосрочной привязанности к услугам агентства.

Таким образом, создание и внедрение базы данных для агентства по аренде недвижимости является важной задачей, позволяющей повысить производительность работы, улучшить качество сервиса и обеспечить конкурентоспособность на рынке. Автоматизация процессов на базе данных помогает агентствам быстро и эффективно управлять своими ресурсами, обеспечивая актуальность и достоверность информации, что является необходимым условием для успешного ведения бизнеса в условиях современной городской жизни.

## Цель
Целью данной работы является создание базы данных для агентства по аренде квартир, которая позволит эффективно организовать и структурировать хранение информации о клиентах, квартирах, договорах аренды и сотрудниках. Данная база данных должна стать основным инструментом для автоматизации процессов, связанных с арендой жилья, обеспечивая агентству возможность быстрее и точнее обрабатывать запросы клиентов и отслеживать взаимодействие между клиентами и агентами. Кроме того, база данных призвана упростить управление информацией, обеспечивая легкий доступ к актуальным данным, что позволит повысить оперативность и надежность обслуживания.

Эта база данных должна не только поддерживать внутренние процессы агентства, но и предоставлять аналитические возможности для мониторинга и оценки эффективности работы агентства. Например, база данных должна быть способна отслеживать наиболее востребованные типы квартир, анализировать динамику аренды по различным параметрам (районы, сезоны, длительность аренды и т.д.) и генерировать отчеты для принятия обоснованных решений. Таким образом, цель разработки базы данных заключается в создании комплексного инструмента, который обеспечит агентству по аренде квартир высокую производительность, улучшит качество клиентского сервиса и позволит лучше адаптироваться к изменениям на рынке аренды жилья.

## Задачи
Для достижения поставленной цели необходимо выполнить следующие задачи:

1. Провести детальный анализ требований к базе данных для агентства по аренде квартир. Определить ключевые процессы, нуждающиеся в автоматизации, а также необходимые категории данных, включая информацию о клиентах, квартирах, договорах аренды, характеристиках жилья, условиях оплаты, а также о персонале агентства. Учитывая специфику рынка аренды, провести исследование, которое позволит выявить важные данные для повышения конкурентоспособности агентства.

2. Разработать структуру базы данных, включающую продуманную схему таблиц и связей между ними, которые будут поддерживать хранение и обработку информации обо всех аспектах аренды. Включить таблицы для данных о клиентах, квартирах, характеристиках объектов, условиях аренды, а также таблицы для учета истории аренды и предпочтений клиентов. Важно учесть возможность расширения базы данных для добавления новых категорий данных при изменении потребностей агентства или появлении новых сервисов.

3. Реализовать таблицы, настроить связи между ними и внедрить необходимые ограничения для обеспечения целостности данных. Установить связи между таблицами так, чтобы база данных поддерживала эффективное управление всеми аспектами аренды жилья. Реализация должна включать проверку данных, поддержку транзакций для предотвращения ошибок, а также тестирование функциональных возможностей для всех категорий пользователей.



 ## 1. Анализ предметной области. Постановка задачи

### 1.1. Описание предметной области и функции решаемых задач
Предметной областью данной базы данных является управление процессом аренды квартир в агентстве недвижимости, которое оказывает комплексные услуги по аренде и сопровождению сделок. Эта сфера деятельности предполагает большой объем разнообразных операций, связанных с систематизацией, хранением и обработкой данных о недвижимости, арендаторах, потенциальных клиентах и заключаемых договорах аренды. Аренда недвижимости — процесс, который требует точности и надежности на каждом этапе, поскольку он включает работу с большими объемами информации, управленческими решениями и важными документами, регулирующими права и обязанности сторон. Система управления базой данных в данном контексте направлена на автоматизацию, стандартизацию и оптимизацию основных процессов агентства, что позволяет сократить затраты времени и повысить качество обслуживания клиентов, создавая удобные условия для взаимодействия с арендодателями и арендаторами.

Ключевой задачей данной системы является **регистрация и хранение информации** обо всех участниках и объектах процесса аренды: о клиентах, сотрудниках, квартирах и условиях договоров аренды. Регистрация данных о клиентах включает не только базовую информацию, такую как имя и контактные данные, но и расширенные сведения, включая историю предыдущих обращений, их запросы, предпочтения по жилью, финансовые возможности, а также потенциальные скидки и льготы, предоставленные клиенту. Такой подход позволяет создавать полное досье на каждого клиента, что помогает сотрудникам агентства лучше понимать потребности каждого арендатора, быстрее обрабатывать запросы и предлагать индивидуальные условия. В отношении сотрудников, система сохраняет сведения о персонале агентства, включая их должностные обязанности, уровень доступа к данным и функции, что помогает четко разграничивать права доступа к информации и улучшает безопасность и конфиденциальность данных. Кроме того, база данных содержит расширенную информацию о каждой квартире: адрес, площадь, количество комнат, состояние ремонта, наличие мебели и бытовой техники, этаж, ориентировка окон, а также стоимость аренды и статус, свободна ли квартира для аренды или уже сдана другому клиенту. 

Использование такой системы управления данными позволяет агентству более эффективно организовать работу по подбору жилья для каждого клиента и сопровождению арендных сделок. Сотрудники могут быстро найти подходящие объекты в базе, опираясь на требования клиента, такие как желаемое количество комнат, диапазон цен, удобное местоположение и предпочтительные характеристики квартиры. Поддержка таких функций позволяет агентству оперативно реагировать на запросы клиентов и предлагать актуальные варианты, что положительно сказывается на уровне удовлетворенности клиентов и помогает агентству поддерживать свою репутацию надежного партнера. 

Кроме того, система облегчает не только подбор и предложение жилья, но и все сопутствующие задачи, связанные с **подготовкой и заключением договоров аренды**. Система позволяет автоматически формировать и сохранять шаблоны договоров, где прописаны условия аренды, права и обязанности сторон, а также сроки и суммы платежей. Это позволяет сотрудникам не тратить время на повторное создание документов и сократить вероятность ошибок, связанных с ручным вводом данных. Благодаря этому агентство может поддерживать высокую скорость обработки документов, что упрощает и ускоряет процесс оформления аренды.

Система управления также облегчает процесс **взаимодействия между агентами и клиентами**, поддерживая функцию отслеживания статуса каждого запроса или заявки. Это значит, что агенты могут видеть, на какой стадии находится заявка клиента — от первичного запроса до подписания договора. Функция обновления статуса позволяет всем сотрудникам агентства в реальном времени получать актуальную информацию о каждом объекте и клиенте. Дополнительно система позволяет вести учет завершенных арендных сделок и организовывать работу с постоянными клиентами, фиксируя особенности их запросов, пожелания и предпочтения, что помогает агентству строить более долгосрочные отношения с клиентами и удерживать их лояльность.

Важной функцией системы является **сбор и анализ данных о всех аспектах арендной деятельности** агентства. Система позволяет формировать статистические отчеты по различным критериям, например, по средней стоимости аренды, востребованности квартир определенного типа или района, загруженности сотрудников и другим показателям. Такие данные помогают агентству оценивать текущие тенденции на рынке, разрабатывать стратегию продаж, а также проводить анализ эффективности работы сотрудников. Например, система может генерировать отчеты по каждой сделке и сотруднику, показывая, какие объекты чаще всего выбирают клиенты, какие параметры квартир наиболее востребованы, как быстро заключаются сделки и насколько качественно обслуживаются клиенты. Эти данные могут использоваться для корректировки стратегий агентства, для улучшения маркетинговой деятельности и оптимизации работы сотрудников.

Использование базы данных значительно упрощает все основные процессы в агентстве, от регистрации и хранения информации до выполнения аналитических и управленческих функций. Автоматизация этих процессов снижает вероятность ошибок, повышает качество обслуживания клиентов, ускоряет взаимодействие сотрудников агентства с клиентами и улучшает прозрачность работы агентства.



### 1.2. Перечень входных данных
Для функционирования системы необходима регистрация следующих данных:

- **Данные клиентов**: включают полные имена клиентов, их контактную информацию (телефон, адрес электронной почты) и другие персональные данные, необходимые для связи и обслуживания.
- **Данные квартир**: содержат адрес объекта, количество комнат, площадь квартиры, стоимость аренды, текущее состояние (например, доступна для аренды или занята), а также дополнительные характеристики, такие как тип ремонта, наличие мебели, этаж и вид из окон.
- **Данные сотрудников**: включают фамилию, имя и отчество сотрудников, занимаемую должность, права доступа к различным данным в системе, а также контактные данные для внутреннего пользования.
- **Данные по аренде**: это информация о заключённых арендных сделках, в частности, данные клиента, конкретная квартира, срок аренды, стоимость аренды, а также условия и статус договора (например, подписан, активен, завершён).

Эти данные используются для поддержки процессов управления, анализа и создания отчетности, а также обеспечения безопасности хранения информации.

### 1.3. Перечень выходных данных

Система формирует обширный перечень выходных данных, который помогает агентству управлять процессами и улучшать клиентский сервис. Основные выходные данные включают:

- **Список доступных квартир**: обновляется в реальном времени и предоставляет информацию о текущих объектах недвижимости, доступных для аренды, с учётом их характеристик, цен и условий. Это позволяет агентству быстро реагировать на запросы клиентов, предлагать актуальные варианты квартир и минимизировать время обработки заявок.

- **История арендных сделок**: содержит подробную запись о всех завершённых и активных арендных сделках, в том числе сведения о каждом заключенном договоре, условиях аренды, сроках, а также историю взаимодействия клиента с агентством. Такая информация помогает агентству отслеживать предпочтения клиентов, анализировать долгосрочные тенденции на рынке аренды и оценивать эффективность сделок.

- **Статистика по аренде**: система предоставляет сводные данные по всем заключённым договорам, суммам арендных платежей, средней стоимости и срокам аренды, а также загрузке объектов в различные периоды. Эти показатели позволяют руководству агентства принимать обоснованные решения и разрабатывать стратегии, учитывающие потребности клиентов и особенности рынка.

### 1.4. Ограничения предметной области

Для корректного функционирования системы необходимо учитывать ряд важных ограничений, которые помогают поддерживать качество данных и соблюдение нормативных требований:

- **Аренда доступна только для свободных квартир**: система обеспечивает строгий контроль статуса всех объектов недвижимости, предотвращая возможность сдачи уже арендованных квартир. Это требование гарантирует актуальность данных и предотвращает возможные конфликты интересов при заключении договоров с несколькими клиентами одновременно.

- **Ограничение доступа к данным сотрудников**: для соблюдения политики конфиденциальности система ограничивает доступ к данным сотрудников агентства, предоставляя их только авторизованным лицам. Доступ к информации регулируется уровнем прав доступа, что помогает минимизировать риски утечки данных и нарушение норм безопасности.

- **Сроки аренды регулируются условиями договоров**: система учитывает, что сроки аренды могут варьироваться в зависимости от условий договора, поэтому предотвращает автоматическое продление аренды сверх предусмотренных сроков, если это не согласовано заранее. Система также контролирует соответствие сроков договора установленным правилам и нормам, что помогает агентству избежать нарушения договорных обязательств и минимизировать риски конфликтных ситуаций.



## 2. Инфологическая (концептуальная) модель базы данных

### 2.1. Выделение информационных объектов
Основными информационными объектами в системе аренды квартир являются:

- **Клиенты**: физические лица, заинтересованные в аренде жилья через агентство недвижимости. Клиенты являются ключевыми участниками процесса аренды, и информация о них необходима для заключения договоров и поддержания долгосрочных отношений с агентством.
- **Квартиры**: объекты недвижимости, предлагаемые для аренды. Квартиры обладают уникальными характеристиками, которые позволяют клиентам делать выбор в соответствии с их потребностями и возможностями.
- **Аренда**: отношение между клиентом и квартирой, фиксирующее параметры аренды. Этот объект описывает детали аренды, такие как период действия договора и стоимость аренды, что позволяет вести учет финансовых транзакций и сроков аренды.
- **Сотрудники**: представители агентства, ответственные за взаимодействие с клиентами и управление процессами аренды. Сотрудники выполняют ключевые функции по координации сделок, взаимодействию с клиентами и обновлению информации о статусе квартир.


### 2.2. Определение атрибутов объектов

Для эффективного управления данными в системе каждому информационному объекту присваиваются определенные атрибуты, которые описывают его уникальные характеристики:

- **Клиенты**:  
  - `ID клиента` — уникальный идентификатор клиента.  
  - `Имя` и `Фамилия` — личные данные клиента для идентификации.
  - `Email` и `Телефон` — контактные данные для связи и уведомлений.
  
- **Квартиры**:  
  - `ID квартиры` — уникальный идентификатор объекта недвижимости.  
  - `Адрес` — местоположение квартиры.
  - `Количество комнат` — число комнат в квартире.
  - `Площадь` — жилая площадь квартиры в квадратных метрах.
  - `Цена` — стоимость аренды, определяемая агентством.
  - `Доступность` — статус, показывающий, свободна ли квартира для аренды.

- **Аренда**:  
  - `ID аренды` — уникальный идентификатор арендной сделки.
  - `ID клиента` — ссылка на клиента, заключившего договор.
  - `ID квартиры` — ссылка на квартиру, сдаваемую в аренду.
  - `Дата начала` и `Дата окончания` — временные рамки действия договора.
  - `Цена аренды` — стоимость аренды за период, указанный в договоре.

- **Сотрудники**:  
  - `ID сотрудника` — уникальный идентификатор сотрудника агентства.
  - `Имя` и `Фамилия` — персональные данные для идентификации.
  - `Должность` — позиция сотрудника в агентстве, что может определять его права и обязанности в системе.


### 2.3. Определение отношений и мощности отношений между объектами
Система управления арендами требует определения связей между объектами для учета всех аспектов процесса аренды. Важно указать, как информационные объекты взаимодействуют друг с другом и какую мощность имеют эти связи:

- **Клиенты - Аренда**:  
  - Один клиент может заключать несколько арендных договоров с агентством, арендовать разные квартиры по отдельным контрактам (например, в случае долгосрочного сотрудничества или одновременной аренды нескольких объектов).  
  - Каждый договор аренды, однако, всегда связан только с одним конкретным клиентом.
  - Отношение имеет мощность 1:N.

- **Квартиры - Аренда**:  
  - Каждая квартира может быть арендована несколько раз с разными клиентами по очереди, что особенно важно для учета истории аренды и управления доступностью объекта.
  - Каждый отдельный договор аренды связан только с одной конкретной квартирой.
  - Отношение имеет мощность 1:N.

- **Сотрудники - Аренда**:  
  - Один сотрудник агентства может быть назначен на ведение множества арендных сделок, выполняя функции сопровождения клиента, управления документацией и контроля сроков аренды.  
  - Каждая аренда связана с одним сотрудником, который отвечает за сделку от начала до завершения.
  - Отношение имеет мощность 1:N.

Эти отношения и их мощности позволяют описать структуру данных и взаимодействие между информационными объектами в системе аренды, обеспечивая поддержку всех функциональных задач агентства.


### 2.4. Построение концептуальной модели
![Фото](1.png)

## 3. Логическая структура базы данных

Логическая структура базы данных описывает, как данные организованы и как они связаны между собой с точки зрения бизнес-правил и требований системы.

1. **Таблица `Clients`** хранит информацию о клиентах. Каждый клиент имеет уникальный идентификатор (`client_id`), имя, фамилию, электронную почту и телефон.
   
2. **Таблица `Apartments`** хранит данные о квартирах, которые агентство сдает в аренду. Каждая квартира имеет уникальный идентификатор (`apartment_id`), адрес, количество комнат, площадь, цену аренды и флаг доступности.

3. **Таблица `Employees`** хранит информацию о сотрудниках агентства. Каждый сотрудник имеет уникальный идентификатор (`employee_id`), имя, фамилию и должность.

4. **Таблица `Rentals`** связывает клиентов с квартирами, которые они арендуют, а также указывает сотрудника, который оформил сделку. Эта таблица включает уникальный идентификатор аренды (`rental_id`), даты начала и окончания аренды, стоимость аренды, а также внешние ключи, связывающие аренду с конкретным клиентом (`client_id`), квартирой (`apartment_id`) и сотрудником (`employee_id`).

#### Важные связи между таблицами:
- **Связь между таблицами `Clients` и `Rentals`**: Один клиент может арендовать несколько квартир, поэтому существует связь "один ко многим" между таблицей клиентов и таблицей аренды. В `Rentals` хранится внешний ключ `client_id`, который ссылается на клиента в таблице `Clients`.
  
- **Связь между таблицами `Apartments` и `Rentals`**: Одна квартира может быть арендована несколько раз, поэтому существует связь "один ко многим" между таблицей квартир и таблицей аренды. В таблице `Rentals` хранится внешний ключ `apartment_id`, который ссылается на квартиру в таблице `Apartments`.

- **Связь между таблицами `Employees` и `Rentals`**: Один сотрудник может оформить несколько сделок аренды, то есть между таблицей сотрудников и таблицей аренды также существует связь "один ко многим". В таблице `Rentals` хранится внешний ключ `employee_id`, который ссылается на сотрудника в таблице `Employees`.

## 4. Физическая структура базы данных в PostgreSQL

Физическая структура базы данных в PostgreSQL описывает, как данные будут храниться в системе управления базами данных, включая использование типов данных, индексов и механизмов хранения данных.

1. **Типы данных**:
   - В PostgreSQL для строковых данных используется тип `VARCHAR`, который может хранить строки переменной длины. Например, для поля `first_name` в таблице `Clients` мы указываем `VARCHAR(50)`.
   - Для уникальных идентификаторов, как в `client_id`, `apartment_id` и других, используется тип `SERIAL`. В PostgreSQL это автоматически создаёт целочисленное поле с автоинкрементом, которое является уникальным для каждой записи.
   - Для флагов и булевых значений используется тип `BOOLEAN`. Например, в таблице `Apartments` поле `available` будет использоваться для хранения информации о доступности квартиры.
   - Для хранения дат в PostgreSQL используется тип `DATE`, что позволяет точно хранить дату без времени.

2. **Индексы**:
   - В PostgreSQL при создании таблиц с первичными ключами автоматически создаются **индексы** для этих ключей. Это ускоряет операции поиска и связывания данных.
   - Для **внешних ключей** PostgreSQL автоматически создает индексы, чтобы ускорить поиск и операции объединения данных. Например, индексы для полей `client_id`, `apartment_id` и `employee_id` в таблице `Rentals` улучшат производительность запросов.

3. **Хранение данных**:
   - В PostgreSQL данные таблиц хранятся на диске в виде файлов в **сегментах** или **таблицах**, которые управляются внутри **табличных пространств**. Каждый сегмент отвечает за хранение данных таблицы, и PostgreSQL эффективно управляет распределением данных между сегментами для обеспечения быстрого доступа.

4. **Ссылочная целостность**:
   - В PostgreSQL гарантируется **ссылочная целостность** через использование внешних ключей. Система автоматически отслеживает целостность данных между таблицами, обеспечивая, чтобы, например, не было аренды без существующего клиента или квартиры.
   - Также PostgreSQL поддерживает различные действия при удалении или обновлении данных с использованием внешних ключей, например, **ON DELETE CASCADE** для автоматического удаления связанных данных при удалении записи.

Таким образом, физическая структура базы данных в PostgreSQL включает использование эффективных типов данных, индексов, механизмов хранения и ссылочной целостности для обеспечения быстрого доступа и защиты данных.

## 5. Реализация проекта в среде конкретной СУБД 

Проект реализуется в среде **PostgreSQL**. 

---

### 5.1. Создание таблиц

Для начала создадим необходимые таблицы для хранения информации о клиентах, квартирах, сотрудниках и договорах аренды. Пример SQL-запросов:

```sql
-- Создание таблицы клиентов
CREATE TABLE Clients (
    client_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100),
    phone VARCHAR(15)
);

-- Создание таблицы квартир
CREATE TABLE Apartments (
    apartment_id SERIAL PRIMARY KEY,
    address VARCHAR(255) NOT NULL,
    number_of_rooms INT,
    area INT,
    price INT NOT NULL,
    available BOOLEAN DEFAULT TRUE
);

-- Создание таблицы сотрудников
CREATE TABLE Employees (
    employee_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    position VARCHAR(50)
);

-- Создание таблицы аренды
CREATE TABLE Rentals (
    rental_id SERIAL PRIMARY KEY,
    client_id INT,
    apartment_id INT,
    employee_id INT,
    start_date DATE,
    end_date DATE,
    rental_price INT,
    FOREIGN KEY (client_id) REFERENCES Clients(client_id),
    FOREIGN KEY (apartment_id) REFERENCES Apartments(apartment_id),
    FOREIGN KEY (employee_id) REFERENCES Employees(employee_id)
);
```

Каждая из этих таблиц имеет свои атрибуты:

Clients — информация о клиентах, включая имя, фамилию, email и телефон.

Apartments — данные о квартирах, такие как адрес, количество комнат, площадь и стоимость аренды.

Employees — данные о сотрудниках агентства, их должности и имена.

Rentals — данные о заключенных договорах аренды, ссылаются на клиента, квартиру и сотрудника, который оформил аренду.


### 5.2. SQL-запросы PostgreSQL для базы данных агентства аренды квартир
Запросы к базе данных агентства аренды квартир играют ключевую роль в обеспечении эффективного управления данными, автоматизации процессов и поддержки бизнес-операций агентства. Используя SQL-запросы, можно выполнять различные действия, такие как добавление, изменение, удаление данных и их анализ. В рамках данной базы данных запросы позволяют:

Управлять информацией о клиентах, квартирах, сотрудниках и аренде: добавлять новых клиентов и сотрудников, обновлять данные о квартирах и договорах аренды.
Получать актуальные данные для анализа и отчетности: получать информацию о доступных квартирах, завершенных арендах, выручке и статистике по аренде.
Поддерживать порядок и точность данных: обновлять или удалять устаревшие данные, такие как истекшие договоры аренды или недействительные контактные данные.
Обеспечить доступ к критически важным данным для принятия решений: с помощью запросов сотрудники агентства могут быстро найти подходящие квартиры для аренды, отслеживать занятость, устанавливать цены и анализировать рыночные тенденции.
Эти запросы позволяют автоматизировать управление базой данных и поддерживать высокую эффективность работы агентства.

```sql
-- 1. Добавление нового клиента
INSERT INTO Clients (first_name, last_name, email, phone)
VALUES ('Анна', 'Смирнова', 'anna.smirnova@example.com', '+79123456789');

-- 2. Добавление новой квартиры
INSERT INTO Apartments (address, number_of_rooms, area, price, available)
VALUES ('ул. Пушкина, д. 10', 2, 55, 30000, TRUE);

-- 3. Добавление нового сотрудника
INSERT INTO Employees (first_name, last_name, position)
VALUES ('Сергей', 'Иванов', 'Менеджер');

-- 4. Создание новой записи об аренде
INSERT INTO Rentals (client_id, apartment_id, employee_id, start_date, end_date, rental_price)
VALUES (1, 2, 1, '2024-11-01', '2025-11-01', 30000);

-- 5. Обновление информации о клиенте
UPDATE Clients SET email = 'new_email@example.com' WHERE client_id = 1;

-- 6. Обновление стоимости аренды квартиры
UPDATE Apartments SET price = 35000 WHERE apartment_id = 2;

-- 7. Удаление записи о клиенте
DELETE FROM Clients WHERE client_id = 5;

-- 8. Удаление записи о квартире
DELETE FROM Apartments WHERE apartment_id = 3;

-- 9. Поиск всех квартир с ценой аренды ниже 30000
SELECT * FROM Apartments WHERE price < 30000;

-- 10. Поиск всех клиентов с указанием email
SELECT * FROM Clients WHERE email IS NOT NULL;

-- 11. Получение всех доступных квартир
SELECT * FROM Apartments WHERE available = TRUE;

-- 12. Поиск клиентов, арендующих квартиры через определенного менеджера
SELECT c.first_name, c.last_name FROM Rentals r
JOIN Clients c ON r.client_id = c.client_id
WHERE r.employee_id = 1;

-- 13. Изменение доступности квартиры
UPDATE Apartments SET available = FALSE WHERE apartment_id = 1;

-- 14. Получение списка всех квартир по убыванию цены
SELECT * FROM Apartments ORDER BY price DESC;

-- 15. Подсчет общего количества клиентов
SELECT COUNT(*) FROM Clients;

-- 16. Подсчет количества занятых квартир
SELECT COUNT(*) FROM Apartments WHERE available = FALSE;

-- 17. Суммарная выручка от всех договоров аренды
SELECT SUM(rental_price) FROM Rentals;

-- 18. Средняя стоимость аренды квартир
SELECT AVG(price) FROM Apartments;

-- 19. Вывод всех договоров аренды, заканчивающихся в текущем месяце
SELECT * FROM Rentals WHERE end_date BETWEEN '2024-11-01' AND '2024-11-30';

-- 20. Обновление должности сотрудника
UPDATE Employees SET position = 'Старший менеджер' WHERE employee_id = 1;

-- 21. Поиск квартир с площадью более 70 кв.м
SELECT * FROM Apartments WHERE area > 70;

-- 22. Поиск всех сотрудников с должностью "Менеджер"
SELECT * FROM Employees WHERE position = 'Менеджер';

-- 23. Удаление всех договоров аренды, срок которых истек
DELETE FROM Rentals WHERE end_date < CURRENT_DATE;

-- 24. Установка скидки на аренду для конкретной квартиры
UPDATE Apartments SET price = price * 0.9 WHERE apartment_id = 2;

-- 25. Получение списка всех клиентов с сортировкой по фамилии
SELECT * FROM Clients ORDER BY last_name;

-- 26. Сотрудники, имеющих хотя бы 1 договор
SELECT DISTINCT e.first_name, e.last_name
FROM Employees e
JOIN Rentals r ON e.employee_id = r.employee_id
WHERE r.end_date >= CURRENT_DATE;

-- 27. Изменение номера телефона клиента
UPDATE Clients SET phone = '+79111234567' WHERE client_id = 1;

-- 28. Добавление нового договора аренды с текущей датой начала
INSERT INTO Rentals (client_id, apartment_id, employee_id, start_date, end_date, rental_price)
VALUES (2, 3, 1, CURRENT_DATE, '2025-11-01', 40000);

-- 29. Подсчет количества договоров аренды по каждому клиенту
SELECT client_id, COUNT(*) AS rental_count
FROM Rentals
GROUP BY client_id;

-- 30. Поиск всех сотрудников, связанных с определенными договорами аренды
SELECT DISTINCT e.first_name, e.last_name FROM Employees e
JOIN Rentals r ON e.employee_id = r.employee_id;
```

# Заключение
В результате выполнения данной курсовой работы была разработана и внедрена база данных для агентства по аренде квартир, представляющая собой целостную систему для хранения и обработки данных, связанных с управлением аренды. Работа включала детальное исследование предметной области: были выявлены ключевые объекты (клиенты, квартиры, сотрудники и аренда), определены их атрибуты и связи. На основе этого анализа построена концептуальная модель данных, которая легла в основу дальнейшего проектирования и разработки базы данных. 

Проект был реализован с использованием системы управления базами данных PostgreSQL, что позволило создать надежную структуру хранения и обеспечить удобный доступ к информации. Спроектированная база данных включает разделы для управления информацией о клиентах, квартирах, условиях аренды, а также данных о сотрудниках. Это решение позволяет агентству эффективно автоматизировать ряд основных бизнес-процессов, включая регистрацию клиентов, отслеживание доступных квартир, организацию процессов аренды и ведение историй аренды.

Кроме того, при помощи базы данных решена задача обработки запросов от клиентов и сотрудников, что упрощает взаимодействие между всеми участниками процесса и способствует повышению уровня сервиса. С помощью SQL-запросов были разработаны и протестированы различные отчеты и аналитические выборки, что позволило наглядно продемонстрировать возможности системы по генерации статистических и аналитических данных. Эти функции обеспечивают агентству не только повышение операционной эффективности и контроль процессов, но и открывают новые возможности для анализа данных, который способствует стратегическому развитию бизнеса и улучшению его управляемости.


 # Список использованных источников

 Корбут А.А. Основы проектирования баз данных. Учебное пособие. — М.: Издательство МГТУ, 2020. 
 
 Официальная документация PostgreSQL. https://www.postgresql.org/docs/





